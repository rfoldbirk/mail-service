<style>
    .card {
        margin: 5px 5px;
        transition: border 0.3s;
    }

    .card:hover {
        border: 1px solid #a5c6fd
    }

    .flexer {
        /* background-color: rgba(0, 0, 0, 0.774); */

        display: flex;
        flex-wrap: wrap;

        justify-content: center;
    }

    .flexer-sb {
        justify-content: space-between;
    }

</style>

<div class="flexer flexer-sb">
    <h1> Dine grupper </h1>
    <button type="button" class="btn btn-outline-success" data-whatever="customID" data-toggle="modal" data-target="#exampleModal2"> Opret gruppe </button>
</div>

<div style="margin-bottom: 50px;"></div>

<div class="flexer" id="CardHolder">
    
    
</div>


<input hidden id="server_groups" value="<%- locals.user.Groups %>">
<button hidden id="opretGruppeClone" type="button" class="btn btn-outline-success" data-whatever="customID" data-toggle="modal" data-target="#exampleModal"></button>
<button hidden id="opretPersonClone" type="button" class="btn btn-outline-success" data-whatever="customID" data-toggle="modal" data-target="#exampleModal2"></button>

<script src="/assets/js/opretGruppe.js"></script>

<script>
    // jeg beholder skriptet her, ellers er der lidt ventetid... det gider jeg ikke!
    const groups = document.getElementById('server_groups').value

    try {
        const G = JSON.parse(groups)
        

    } catch (err) {
        // så er der ikke nogen grupper
        let div = createCard('I begyndelsen var der stille...', 0, 'Hvad med at oprette en ny gruppe?!', true)
        
        
        div.querySelector('h6').remove()
        div.querySelector('p').style['margin-top'] = '32px'
        // div.querySelector('button').innerText = "Opret gruppe"

        div.querySelector('button').remove()
        let btn2 = document.getElementById('opretPersonClone')
        div.querySelector('div').appendChild(btn2)
        btn2.innerText = "Opret gruppe"
        btn2.hidden = false


        div.querySelector('a').remove()
    }


    function createCard(titel, medlemmer, beskrivelse) {
        const father = document.getElementById('CardHolder')
        if (!father || !titel || !beskrivelse) return

        let outerDiv = document.createElement('div')
        outerDiv.classList = "card"
        outerDiv.style['width'] = "18rem"

        let innerDiv = document.createElement('div')
        innerDiv.classList = "card-body shadow"

        let h5 = document.createElement('h5')
        h5.classList = "card-title"
        h5.innerText = titel

        
        let h6 = document.createElement('h6')
        h6.classList = "card-subtitle mb-2 text-muted"
        let ending = (medlemmer != 1 ) ? 'medlemmer' : 'medlem'
        h6.innerText = medlemmer + ' ' + ending
    

        let p = document.createElement('p')
        p.classList = "card-text"
        p.innerText = beskrivelse

        let btn = document.querySelector('#opretGruppeClone').cloneNode()
        btn.innerText = 'Tilføj person'
        btn.hidden = false

        let a = document.createElement('a')
        a.classList = 'btn btn-outline-primary'
        a.style['float'] = 'right'
        a.href = '#'
        a.innerText = 'Rediger'

        // appending

        innerDiv.appendChild(h5)
        innerDiv.appendChild(h6)
        innerDiv.appendChild(p)
        innerDiv.appendChild(btn)
        innerDiv.appendChild(a)

        outerDiv.appendChild(innerDiv)
        father.appendChild(outerDiv)

        return outerDiv
    }
</script>

<!-- Modal -->

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"> Tilføj en ny person </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Fornavn:</label>
            <input type="text" class="form-control" id="firstname">
          </div>
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Efternavn:</label>
            <input type="text" class="form-control" id="lastname">
          </div>

          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Email:</label>
            <input type="text" class="form-control" id="email">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal"> Annuller </button>
        <button type="button" class="btn btn-success"> Tilføj </button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel"> Opret en ny gruppe </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <div class="col-md-12 mb-3">
              <label>Gruppe navn </label>
              <span class="badge badge-pill badge-warning"> Påkrævet </span>
              <input id="gruppeNavnInput" type="text" class="form-control" placeholder="Tennisklub" required>
              <div class="invalid-feedback">
                Navnet eksisterer allerede
              </div>
            </div>
          </div>
          <div class="form-group">
            <div class="col-md-12 mb-3">
              <label >Beskrivelse</label>
              <span class="badge badge-pill badge-info"> Valgfrit </span>
              <textarea id="gruppeBeskInput" class="form-control" rows="3"></textarea>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="annullerGruppeBtn" type="button" class="btn btn-primary" data-dismiss="modal"> Annuller </button>
        
        <button id="opretGruppeBtn" class="btn btn-success" type="button">
          <span hidden="true" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          <span>Opret gruppe</span>
        </button>
      </div>
    </div>
  </div>
</div>